---
description: "Luqma project context: Recipe search application with Spring Boot backend and React frontend"
alwaysApply: true
---
# Luqma Project Context

## Overview

Recipe search application with nutritional information and dynamic ingredient exclusion.

## Tech Stack

**Backend:** Spring Boot 3.5.7, Java 25, Gradle, Spoonacular API, JaCoCo

**Frontend:** React 19.2.0, Vite 7.2.2, TailwindCSS 4.1.17, React Router 7.9.5, Context API, Vitest

## Architecture

**Security (Critical):**
- Backend proxies all Spoonacular API calls
- Frontend calls backend only, never external APIs
- API keys never in frontend or version control

**Data Flow:** User â†’ React UI â†’ Backend API â†’ Spoonacular

**Backend Structure** (`backend/src/main/java/app/luqma/backend/`):
- controller/: âœ… REST endpoints (RecipeController)
- service/: âœ… Business logic (RecipeSearchService, RecipeDetailService, IngredientValidationService, NutritionCalculationService)
- filter/: âœ… Servlet filters (RateLimitFilter)
- client/: ðŸš§ Spoonacular API client - PENDING (currently using mock data)
- repository/: âœ… Data access (MockRecipeRepository)
- mapper/: âœ… Object mapping (RecipeMapper, NutrientExtractor)
- model/dto/: âœ… API request/response DTOs (RecipeSearchResponse, RecipeSummary, RecipeDetailResponse, IngredientDTO, NutritionDTO, ExcludeIngredientsRequest)
- model/domain/: âœ… Internal domain models (RecipeDetail, ExtendedIngredient, NutritionInfo, Nutrient, AnalyzedInstruction, InstructionStep)
- config/: âœ… Spring configuration (CORS, Security, Rate Limiting, RecipeSearch properties)
- exception/: âœ… Custom exceptions + GlobalExceptionHandler with comprehensive error handling
- constants/: âœ… Application constants (ErrorMessages, NutrientNames)
- util/: âœ… Utility classes (StringSanitizer, MockDataLoader, CollectionUtils, DefaultValue)

**Frontend Structure** (`frontend/src/`):
- pages/: Route pages with feature-based organization
  - about/: AboutPage.jsx, FeatureCard, FeaturesSection, MissionSection
  - recipe/: RecipePage with features subdirectory
    - features/detail/: RecipeDetail, RecipeHeader, RecipeImage, RecipeMetadata components
    - features/exclusion/: IngredientExclusionPanel (Desktop/Mobile variants), ExcludedIngredientsList
    - features/nutrition/: CollapsibleNutrition, NutritionCard, NutritionContent
    - ingredients/: IngredientList
  - HomePage.jsx
- components/: Shared components
  - layout/: Header (with mobile menu components), Footer, HeroSection, SkipLink, Container
  - recipe/: card/ (RecipeCard, RecipeGrid), ingredients/ (IngredientItem), instructions/ (InstructionStep), nutrition/
  - search/: SearchBar, SearchResults, Pagination (with subcomponents), ResultsHeader
  - ui/: UI primitives (Button, Card, Alert, LoadingSpinner, Badge, Typography, Collapsible, LiveRegion, Skeleton, Checkbox)
- contexts/: React Context providers (RecipeExclusionContext)
- hooks/: Custom hooks
  - State & Data: useImageFallback, useMobileMenu, usePaginationLogic, useRecipeDetail, useSearch, useSearchRecipes, useSearchState, useApiMutation
  - Accessibility: useKeyboardNavigation (grid navigation, shortcuts, focus trap)
- services/: âœ… API client (apiClient.js with searchRecipes, getRecipeById, excludeIngredients)
- utils/: Helper functions (httpClient, iconRegistry, colorUtils, logger)
- constants/: âœ… Application constants (api, ui, validation)
- test/: Test files and mocks/

**Development Approach:**
- Backend uses mock data from `backend/src/main/resources/mocks/` for both search and recipe details
- Mock data replicates Spoonacular API responses for offline development
- Backend endpoints (/api/v1/recipes/search and /api/v1/recipes/{id}) are functional with mock data
- Frontend connects to backend API for all data
- Spoonacular API integration will replace mock data when implemented

## API Endpoints

**Backend REST API:**
- âœ… GET /api/v1/recipes/search - Search recipes with pagination (query, page, pageSize params)
- âœ… GET /api/v1/recipes/{id} - Get recipe details with ingredients, nutrition, and instructions
- âœ… POST /api/v1/recipes/{id}/exclude-ingredients - Exclude ingredients and recalculate nutrition

**Health & Monitoring:**
- GET /actuator/health - Health check
- GET /actuator/health/liveness - Liveness probe
- GET /actuator/health/readiness - Readiness probe
- GET /actuator/info - Application info

**API Documentation:**
- Swagger UI: ${BACKEND_URL}/swagger-ui.html (when running)

**Spoonacular API (external API used in backend only):**
- GET /recipes/complexSearch
- GET /recipes/{id}/information
- GET /food/ingredients/{id}/information

## Environment Variables

**Backend (`backend/.env`):**
- SPOONACULAR_API_KEY (required)
- SPRING_PROFILES_ACTIVE (optional, defaults to `dev`)

**Frontend (`frontend/.env`):**
- LUQMA_API_URL (Backend API endpoint, default: `http://localhost:8080/api/v1`)

## Commands

**Backend:**
- ./gradlew bootRun (run with dev profile)
- npm run dev:backend (from root)
- ./gradlew test

**Frontend:**
- npm run dev (from root, starts at http://localhost:3000)
- npm run dev:frontend (from root)
- cd frontend && npm run dev
- npm run build
- npm test
- npm run lint:fix

## Architectural Patterns

**Backend (ADR-0009):**
- Layered: Controller â†’ Service â†’ Repository
- Controllers: HTTP concerns only
- Services: Business logic
- Repositories: Data access (currently mock)

**Frontend:**
- Feature-based organization (ADR-0007): pages/{page}/features/{feature}/
- Custom hooks for logic (ADR-0008): useRecipeDetail, useSearch, etc.
- Context API for cross-component state (ADR-0004): RecipeExclusionContext
- URL state for search (ADR-0005): shareable URLs, 300ms debounce

**Development (ADR-0006):**
- Mock data in `backend/src/main/resources/mocks/*.json`
- Offline development without API calls
- Migration path: mock â†’ real API

## Documentation

**ADRs:** docs/decisions/ (MADR format) - 9 architectural decisions

**Standards:** .cursor/rules/ (root), backend/.cursor/rules/, frontend/.cursor/rules/

**Key Principles:**
- Separation of concerns
- Simplicity over complexity
- Security first (API keys, WCAG 2.1 AA)
- Independent testability
- Accessibility first (WCAG 2.1 AA, keyboard navigation, screen readers)
