---
description: "Luqma project context: Recipe search application with Spring Boot backend and React frontend"
alwaysApply: true
---
# Luqma Project Context

## Overview

Recipe search application with nutritional information and dynamic ingredient exclusion.

For tech stack details, features, and setup, see [main README](../README.md).

## Architecture

**Security (Critical):**
- Backend proxies all Spoonacular API calls
- Frontend calls backend only, never external APIs
- API keys never in frontend or version control

**Data Flow:** User → React UI → Backend API → Spoonacular

**Backend Structure** (`backend/src/main/java/app/luqma/backend/`):
- controller/: ✅ REST endpoints (RecipeController)
- service/: ✅ Business logic (RecipeSearchService, RecipeDetailService, IngredientValidationService, NutritionCalculationService)
- filter/: ✅ Servlet filters (RateLimitFilter)
- client/: ✅ Spoonacular API client (SpoonacularClient with RestClient)
- repository/: ✅ Data access (RecipeRepository with Spring Cache)
- mapper/: ✅ Object mapping (RecipeMapper, NutrientExtractor)
- model/dto/: ✅ API request/response DTOs (RecipeSearchResponse, RecipeSummary, RecipeDetailResponse, IngredientDTO, NutritionDTO, ExcludeIngredientsRequest) + Spoonacular DTOs
- model/domain/: ✅ Internal domain models (RecipeDetail, ExtendedIngredient, NutritionInfo, Nutrient, AnalyzedInstruction, InstructionStep)
- config/: ✅ Spring configuration (CORS, Security, Rate Limiting, RecipeSearch properties, Spoonacular, Cache)
- exception/: ✅ Custom exceptions + GlobalExceptionHandler with comprehensive error handling (including ExternalApiException)
- constants/: ✅ Application constants (ErrorMessages, NutrientNames)
- util/: ✅ Utility classes (StringSanitizer, MockDataLoader, CollectionUtils, DefaultValue)

**Frontend Structure** (`frontend/src/`):
- pages/: Route pages with co-located page-specific components
  - about/: AboutPage, FeatureCard, FeaturesSection, MissionSection
  - recipe/: RecipePage with page-specific components
    - detail/: RecipeDetail, RecipeHeader, RecipeImage, RecipeMetadataBadge, RecipeMetadataGroup
    - ingredients/: Page-specific ingredient components
    - instructions/: Page-specific instruction components
    - nutrition/: Page-specific nutrition components
    - RecipeContent, RecipeErrorState, RecipeLoading, RecipePage
  - HomePage.jsx
- components/: Shared components used across multiple pages
  - about/: Shared about components (FeatureCard)
  - layout/: Header (with mobile menu components), Footer, HeroSection, SkipLink, Container
  - recipe/: card/ (RecipeCard, RecipeGrid), detail/, ingredients/, instructions/, nutrition/
  - search/: SearchBar, SearchResults, Pagination (with subcomponents), ResultsHeader
  - ui/: UI primitives (Button, Card, Alert, LoadingSpinner, Badge, Typography, Collapsible, LiveRegion, Skeleton, etc.)
- contexts/: React Context providers (RecipeExclusionContext)
- hooks/: Custom hooks
  - State & Data: useImageFallback, useIngredientExclusion, useMobileMenu, usePaginationLogic, useRecipeDetail, useRecipeExclusion, useSearch, useSearchRecipes, useSearchState, useApiMutation
  - Accessibility: useKeyboardNavigation (grid navigation, shortcuts, focus trap)
- services/: ✅ API client (apiClient.js with searchRecipes, getRecipeById, excludeIngredients)
- utils/: Helper functions (httpClient, iconRegistry, colorUtils, logger)
- constants/: ✅ Application constants (api, ui, validation)
- test/: Test files and mocks/

**Development Approach:**
- Backend integrates with Spoonacular API (see [Backend README](../../backend/README.md#spoonacular-api-integration))
- Frontend calls backend only, never external APIs directly
- Comprehensive error handling for rate limits, network errors, and API failures

## API Endpoints

**Backend REST API:**
- GET /api/v1/recipes/search - Search recipes with pagination
- GET /api/v1/recipes/{id} - Get recipe details
- POST /api/v1/recipes/{id}/exclude-ingredients - Exclude ingredients and recalculate nutrition

For detailed API documentation, see [API Documentation](../../docs/api/README.md).

## Environment Variables

Backend requires `SPOONACULAR_API_KEY` in `backend/.env`. See [Backend README](../../backend/README.md#configuration) and [Frontend README](../../frontend/README.md#configuration) for full configuration details.

## Commands

For all commands, see [main README](../README.md), [Backend README](../../backend/README.md), and [Frontend README](../../frontend/README.md).

## Architectural Patterns

**Backend (ADR-0009):**
- Layered: Controller → Service → Repository → Client
- Controllers: HTTP concerns only
- Services: Business logic
- Repositories: Data access with caching
- Clients: External API integration (SpoonacularClient)

**Frontend:**
- Feature-based organization (ADR-0007): Co-located page-specific components in pages/{page}/, shared components in components/
- Custom hooks for logic (ADR-0008): useRecipeDetail, useSearch, useIngredientExclusion, useKeyboardNavigation, etc.
- Context API for cross-component state (ADR-0004): RecipeExclusionContext
- URL state for search (ADR-0005): shareable URLs, 300ms debounce

**Spoonacular Integration:**
See [Backend README](../../backend/README.md#spoonacular-api-integration) for implementation details.

## Documentation

See [Documentation Index](../../docs/README.md) for all documentation.

**Key Principles:**
- Separation of concerns
- Simplicity over complexity
- Security first (API keys never in frontend)
- Independent testability
- Accessibility first (WCAG 2.1 AA)
